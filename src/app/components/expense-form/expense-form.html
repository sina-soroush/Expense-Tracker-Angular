<div class="form-container">
  <div class="form-header">
    <h1>
      <lucide-icon [img]="isEditMode ? PencilIcon : PlusIcon" [size]="28" style="display: inline-block; vertical-align: middle; margin-right: 8px;"></lucide-icon>
      {{ isEditMode ? 'Edit Expense' : 'Add New Expense' }}
    </h1>
  </div>

  <form [formGroup]="expenseForm" (ngSubmit)="onSubmit()" class="expense-form">
    
    <!-- Title and Amount Fields in one row (60/40) -->
    <div class="form-row title-amount-row">
      <div class="form-group form-group-60">
        <label for="title">Title / Description *</label>
        <input 
          type="text" 
          id="title" 
          formControlName="title"
          placeholder="e.g., Grocery Shopping"
          [class.error]="isFieldInvalid('title')">
        
        <div class="error-message" *ngIf="hasError('title', 'required')">
          Title is required
        </div>
        <div class="error-message" *ngIf="hasError('title', 'minlength')">
          Title must be at least 3 characters long
        </div>
      </div>

      <div class="form-group form-group-40">
        <label for="amount">Amount/Price *</label>
        <div class="amount-input-wrapper">
          <button type="button" class="amount-btn minus-btn" (click)="decrementAmount()">
            <span>âˆ’</span>
          </button>
          <input 
            type="number" 
            id="amount" 
            formControlName="amount"
            placeholder="0.00"
            step="0.01"
            min="0"
            [class.error]="isFieldInvalid('amount')">
          <button type="button" class="amount-btn plus-btn" (click)="incrementAmount()">
            <span>+</span>
          </button>
        </div>
        
        <div class="error-message" *ngIf="hasError('amount', 'required')">
          Amount is required
        </div>
        <div class="error-message" *ngIf="hasError('amount', 'min')">
          Amount must be greater than 0
        </div>
      </div>
    </div>

    <!-- Category and Date Fields in one row -->
    <div class="form-row">
      <div class="form-group form-group-half">
        <label for="category">Category *</label>
        <ng-select
          id="category"
          formControlName="category"
          [items]="categoryOptions"
          bindLabel="label"
          bindValue="value"
          placeholder="Select a category"
          [clearable]="false"
          [searchable]="false"
          [class.error]="isFieldInvalid('category')">
          <ng-template ng-label-tmp let-item="item">
            <span class="category-label" *ngIf="item">
              <span class="category-icon" *ngIf="item.icon">
                <lucide-icon [img]="item.icon" [size]="18"></lucide-icon>
              </span>
              <span>{{item.label}}</span>
            </span>
          </ng-template>
          <ng-template ng-option-tmp let-item="item">
            <span class="category-option">
              <span class="category-icon">
                <lucide-icon [img]="item.icon" [size]="18"></lucide-icon>
              </span>
              <span>{{item.label}}</span>
            </span>
          </ng-template>
        </ng-select>
        
        <div class="error-message" *ngIf="hasError('category', 'required')">
          Category is required
        </div>
      </div>

      <div class="form-group form-group-half">
        <label for="date">Date *</label>
        <input 
          #dateInput
          type="text" 
          id="date" 
          formControlName="date"
          placeholder="Select date"
          [class.error]="isFieldInvalid('date')">
        
        <div class="error-message" *ngIf="hasError('date', 'required')">
          Date is required
        </div>
      </div>
    </div>

    <!-- Form Actions -->
    <div class="form-actions">
      <button type="submit" class="btn btn-primary">
        {{ isEditMode ? 'Update Expense' : 'Add Expense' }}
      </button>
      <button type="button" (click)="onCancel()" class="btn btn-secondary">
        Cancel
      </button>
    </div>
  </form>
</div>
